// Assembles the solution matrix and the RHS

// U_Feet is NNMX3 where each row is the global node number the departure foot is assocaited 
// with and the entires in the row are the x,y coordinates of the departure foot followed by 
// the ellemnt the foot is located in

// A and F come in initialized to zeros

// !!!!!!!!!!!!! addd sparse matrix utilization!!!!!!!!!!!!

#ifndef Assembly_H_Guard
#define Assembly_H_Guard

#include "Epetra_SerialDenseMatrix.h"
#include "Epetra_IntSerialDenseMatrix.h"
#include "Epetra_SerialDenseVector.h"

#include "Epetra_Map.h"
#include "Epetra_Vector.h"
#include "Epetra_CrsMatrix.h"

typedef Epetra_SerialDenseMatrix E_SDM;
typedef Epetra_IntSerialDenseMatrix E_ISDM;
typedef Epetra_SerialDenseVector E_SDV;

typedef Epetra_CrsMatrix E_CM;
typedef Epetra_Map E_Mp;
typedef Epetra_Vector E_V;

void Assembly(double RE, 
	      double NEW_VIS, 
	      double TIMESTEP, 
	      int Vel_Npe, 
	      int Pre_Npe,
	      int Nem, 
	      int N_TRI_QUAD,
	      int Vel_Nnm,
	      int Pre_Nnm,
	      E_ISDM Vel_Nod, 
	      E_ISDM Pre_Nod, 
	      E_SDM Vel_Glxy, 
	      E_SDM Pre_Glxy, 
	      E_ISDM Ele_Neigh,
	      int VEL_FLAG,
	      int PRE_FLAG, 
	      E_SDM Tri_Quad_Pt, 
	      E_SDV Tri_Quad_Wt, 
	      E_SDM Str, 
	      E_SDM Vel,
	      E_SDM Vel_Old,
	      E_SDM & A, 
	      E_V & F);
#endif